<%-
lnk=""
lnk2=""
lnk3=""
if_link("server") do 
   lnk = link("server")
   lnk2 = link("server")
end
if_link("shard-server") do          
   lnk2 = link("shard-server")
end
if_link("config-server") do          
   lnk = link("config-server")
end

mongo_port = lnk2.p("port")
mongo_hosts = []
mongo_ports = []
mongo_name = []
mongo_index = []
lnk2.instances.each do |instance|
  mongo_hosts << "#{instance.address}"
  mongo_ports << "#{mongo_port}"
end

if lnk.p('replication.enable') == 0 
  mongo_replicasetname = ""
else
  mongo_replicasetname = lnk2.p("replication.replica_set_name")
end
if lnk.p('require_ssl') == 1
  ca_cert = "/var/vcap/jobs/mongodb-acceptance-tests/ssl/CA.crt"
else
  ca_cert = ""
end
-%>
{
  "timeout_scale":                    <%= p('timeout_scale') %>,
  "mongo_hosts":                      <%= mongo_hosts.to_json %>,
  "mongo_ports":                      <%= mongo_ports.to_json %>,
  "mongo_root_username":              "<%= lnk.p('root_username') %>",
  "mongo_root_password":              "<%= lnk.p('root_password') %>",
  "mongo_replica_set_name":           "<%= mongo_replicasetname %>",
  "mongo_replica_set_enable":         <%= lnk.p('replication.enable') %>,
  "mongo_require_ssl":                <%= lnk.p('require_ssl') %>,
  "mongo_cert":                       "<%= ca_cert %>"
}
